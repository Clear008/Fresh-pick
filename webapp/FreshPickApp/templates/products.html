{% extends 'base.html' %}
    
{% block content %}
<div class="container mx-auto py-8">
    <h1 class="text-xl font-bold mt-4 px-2 lg:px-0">All Category</h1>
    <div class="mt-4 text-white inline-flex items-center flex-wrap space-y-2 px-2 lg:px-0">
        <button class="gap-2 inline-flex items-center mr-2 bg-[#3A8002] px-4 py-2 rounded font-semibold">
            Categories
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down"><path d="m6 9 6 6 6-6"/></svg>
        </button>
        <button class="gap-2 inline-flex items-center mx-2 bg-[#3A8002] px-4 py-2 rounded font-semibold">
            Price
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down"><path d="m6 9 6 6 6-6"/></svg>
        </button>
        <button class="gap-2 inline-flex items-center mx-2 bg-[#3A8002] px-4 py-2 rounded font-semibold">
            Offer
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down"><path d="m6 9 6 6 6-6"/></svg>
        </button>
        <button class="gap-2 inline-flex items-center mx-2 bg-[#3A8002] px-4 py-2 rounded font-semibold">
            Best Seller
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down"><path d="m6 9 6 6 6-6"/></svg>
        </button>
    </div>
    <div class="flex items-center lg:gap-4 mt-8 !flex-wrap justify-center">
        {% for product in products %}
        {% if product.quantity_available > 0 %}
        <div class="card w-1/2 md:w-1/3 lg:w-1/6 p-1 rounded-lg shadow-lg px-4 py-6 hover:shadow-2xl transition-all duration-300">
            <div class="card-img mx-auto text-center relative">
                <img src="{{ product.image }}" alt="img"  class="text-center mx-auto">
                <span class="absolute top-0 right-[20px] badge px-4 py-2 rounded-full bg-red-600 text-white font-semibold">${{ product.price }}</span>
            </div>
            
            <div class="card-desc inline-flex items-center justify-between w-full px-4 mt-4">
                <div class="product">
                    <h1 class="text-xl font-semibold text-[#333333]">{{ product.name }}</h1>
                    <div class="inline-flex items-center mt-[3px]">
                        <svg xmlns="http://www.w3.org/2000/svg" width="19" height="19" viewBox="0 0 24 24" fill="#b9c3cc" stroke="#b9c3cc" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-star"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>
                        <svg xmlns="http://www.w3.org/2000/svg" width="19" height="19" viewBox="0 0 24 24" fill="#b9c3cc" stroke="#b9c3cc" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-star"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>
                        <svg xmlns="http://www.w3.org/2000/svg" width="19" height="19" viewBox="0 0 24 24" fill="#b9c3cc" stroke="#b9c3cc" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-star"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>
                        <svg xmlns="http://www.w3.org/2000/svg" width="19" height="19" viewBox="0 0 24 24" fill="#b9c3cc" stroke="#b9c3cc" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-star"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>
                        <svg xmlns="http://www.w3.org/2000/svg" width="19" height="19" viewBox="0 0 24 24" fill="#b9c3cc" stroke="#b9c3cc" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-star"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>
                    </div>
                </div>
                
                <button class="text-[#3A8002] border border-[#3A8002] rounded-full p-2 bg-gray-100 hover:bg-green-700 hover:text-white transition-all duration-300" onclick="openModal('{{ product.id }}', '{{ product.name }}', '{{ product.price }}', '{{ product.description }}', '{{ product.image }}')">
                    <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-shopping-basket"><path d="m15 11-1 9"/><path d="m19 11-4-7"/><path d="M2 11h20"/><path d="m3.5 11 1.6 7.4a2 2 0 0 0 2 1.6h9.8a2 2 0 0 0 2-1.6l1.7-7.4"/><path d="M4.5 15.5h15"/><path d="m5 11 4-7"/><path d="M12 2v5"/></svg>
                </button>
            </div>
            <!-- <div class="product-price px-4">
                <h1 class="text-red-600 font-semibold text-lg">${{ product.price }}</h1>
            </div> -->
        </div>
        {% endif %}
        {% endfor %}
    </div>
    
    <!-- Modal -->
    <div class="fixed inset-0 flex items-center justify-center bg-gray-900 bg-opacity-50 z-50 hidden" id="productModal">
        <div class="bg-white rounded-lg p-6 max-w-lg w-full relative">
            <button class="absolute top-2 right-2 text-gray-600 hover:text-gray-900" onclick="closeModal()">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
            </button>
            <img id="productImage" src="" alt="Product Image" class="w-full h-48 object-contain rounded-t-lg">
            <h2 class="text-2xl font-bold mt-4 text-[#333333]" id="productName"></h2>
            <p class="text-gray-600 mt-2 text-[#333333]" id="productDescription"></p>
            <p class="text-xl font-semibold text-green-700 mt-4" id="productPrice"></p>
            
            <form id="addToCartForm" method="post" action="{% url 'add_to_cart' %}" class="mt-6">
                {% csrf_token %}
                <input type="hidden" name="product_id" id="productId">
                <div class="inline-flex items-center gap-2">
                    <label for="quantity" class="block text-lg text-gray-700 font-semibold">Quantity:</label>
                    <input type="number" name="quantity" id="quantity" min="1" max="5" value="1" class="mt-1 text-lg font-semibold block border border-[#333333] p-2 w-16 h-10 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring focus:ring-indigo-500 focus:ring-opacity-50"> 
                    <h1 class="italic text-red-600 ">The Maximum is 5KGs</h1>
                    {% if messages %}
                        <div>
                            {% if error_message %}
                                <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative" role="alert">
                                    <span class="block sm:inline">{{ error_message }}</span>
                                </div>
                            {% endif %}
                        </div>
                    {% endif %}
                </div>
                <button type="submit" class="w-full bg-green-600 text-white font-semibold py-2 px-4 rounded mt-4 hover:bg-green-700 transition-all duration-300">Add to Cart</button>
            </form>
        </div>
    </div>
    
    <script>
        function openModal(id, name, price, description, image) {
            document.getElementById('productId').value = id;
            document.getElementById('productName').innerText = name;
            document.getElementById('productPrice').innerText = '$' + price;
            document.getElementById('productDescription').innerText = description;
            document.getElementById('productImage').src = image;
            document.getElementById('productModal').classList.remove('hidden');
        }
        
        function closeModal() {
            document.getElementById('productModal').classList.add('hidden');
        }
    </script>
    <script>
        // Function to generate random color between two hex colors
        // Function to generate random color between two hex colors
        function randomColor() {
            var goldenColor = "#FFD700";
            var b9c3cc = "#b9c3cc";
            var colors = [goldenColor, b9c3cc];
            return colors[Math.floor(Math.random() * colors.length)];
        }

        // Select last three SVG elements
        var svgs = document.querySelectorAll('svg.lucide-star:nth-last-child(-n+3)');

        // Loop through each SVG and set random fill color
        svgs.forEach(function(svg) {
            svg.style.fill = randomColor();
            svg.style.stroke = svg.style.fill;
        });

        // Set first two SVG elements to gold color
        var firstTwoSvgs = document.querySelectorAll('svg.lucide-star:nth-child(-n+3)');
        firstTwoSvgs.forEach(function(svg) {
            svg.style.fill = "#FFD700";
            svg.style.stroke = svg.style.fill;
        });

        // Set the remaining SVG elements to gray color
        var remainingSvgs = document.querySelectorAll('svg.lucide-star:nth-child(n+5)');
        remainingSvgs.forEach(function(svg) {
            svg.style.fill = "#b9c3cc";
            svg.style.stroke = svg.style.fill;
        });
        
    </script>
</div>
{% endblock %}